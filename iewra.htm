<!DOCTYPE html>
<html>
<head>
    <title>WebRTCAPI</title>
	<script src="socket.io.min.js"></script>
	<script src="ie.js"></script>
	<script>
		function a()
		{
			// activex must exit first
		}
	</script>

</head>

<body onbeforeunload="a()">
<!--
do I need this for something?
	<button onclick="callActiveX()">activex</button>

	<script src="/socket.io/socket.io.js"></script>
enable debugging:

http://social.msdn.microsoft.com/Forums/ie/en-US/4491d5e8-e25b-4976-bc19-6bc54ebab649/having-trouble-debugging-activex-controls-with-visual-studio-2008-and-windows-7?forum=ieextensiondevelopment

				HKCU\Software\Microsoft\Internet Explorer\Main: TabProcGrowth = 0 (DWORD)

-->
	<br>
	<button onclick="auth()">auth</button>
	<button onclick="run()">run</button>
	<button onclick="init()">init</button>
	<button onclick="conn()">conn</button>
	<button onclick="debug()">debug</button>
	<button onclick="quit()">quit</button>
	<br>
    
    <object id="WebRTCAPI"
            classid="CLSID:0E8D29CE-D2D0-459A-8009-3B34EFBC43F0"
            height=400
            width=800></object>
    
	<div id='divMe'></div>
	<div id='divPeers'> </div>
	<div id='divATL'> </div>
	<div id='divSDP'> </div>
	<div id='divLog'> </div>

	<script for="WebRTCAPI" event="EventToBrowser(json)">
		asyncEvent(JSON.parse(json));
	</script>

    <script type="text/javascript">

        var obj = document.getElementById("WebRTCAPI").object;
		register(obj);

		function quit() {
			obj.pushToNative('quit', '');
		}

		function init() {
			obj.pushToNative('init', '');
		}

		function conn() {
			obj.pushToNative('conn', '');
		}

		function debug() {
			obj.pushToNative('debug', '');
		}

		function run() {
			obj.run();
		}

//		window.onbeforeunload = function() {
//			alert('quit');
//			obj.quit();
//		}

//        setTimeout(function () {
//			alert('call run to setup shit');
 //           obj.run();
  //      }, 1 * 1000);

    </script>

</body>
</html>
